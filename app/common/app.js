/**
 * Sixcious
 * @copyright (c) 2020 Six
 * @license https://sixcious.com/LICENSE
 */
class App{static async init(){App.router(),App.prepareItems(),await App.prepareMessages(),UI.prepare(V.DOM,V.items),App.addEventListeners(),App.updateStaticElements("all")}static router(){const e=window.location.pathname.split("/");V.path=Util.isEmptyArray(e)?"default":3===e.length&&"special"===e[2]?"special":e[1]}static pushState(e,t){window.history.pushState(void 0,void 0,t||new URL(window.location.href).origin+"/"+e)}static popState(){App.router(),App.changeView(void 0,"init")}static prepareItems(){V.items.theme=App.storageGet("theme")||"system",V.items.drawer=App.storageGet("drawer")||"closed"}static async prepareMessages(){try{const e="/-locales/en/messages.json",t=await fetch(e);V.messages=await t.json()}catch(e){}}static addEventListeners(){window.addEventListener("popstate",App.popState),window.addEventListener("click",App.clickListener),V.DOM["#drawer-button-2"].addEventListener("click",App.clickDrawer),V.DOM["#drawer-list"].addEventListener("click",App.changeView),V.DOM["#theme-button"].addEventListener("click",App.changeTheme)}static updateStaticElements(e){"all"!==e&&"theme"!==e&&"language"!==e||(V.DOM["#theme-icon"].children[0].setAttribute("href","/lib/feather/feather.svg#"+("light"===V.items.theme?"sun":"dark"===V.items.theme?"moon":"sun-moon")),Tooltip.updateTooltip(V.DOM["#theme-button"],Util.i18nGetMessage("theme_button_tooltip",["theme",Util.i18nGetMessage("theme_"+V.items.theme+"_label")]),!0)),"all"===e&&("opened"===V.items.drawer&&App.clickDrawer(),App.changeView(void 0,"all"===e?"init":"theme"))}static clickDrawer(){const e=MDC.drawers.get("app-drawer"),t=!!e.open;e.open?e.foundation_.close():e.foundation_.open(),V.items.drawer=t?"closed":"opened",App.storageSet("drawer",V.items.drawer)}static changeView(e,t){const a=["url-incrementer","infy-scroll","downloadyze","elempick","url-increment-button","url-decrement-button"],i=["default","about","help","privacy-policy","special"].concat(a);let s;if(void 0===e||t)s=i.includes(V.path)?V.path:"default";else{const e=MDC.lists.get("drawer-list");s=e.listElements[e.selectedIndex].dataset.value,App.pushState(s)}for(const e of i)V.DOM["#"+e].dataset.display=s===e?"":"none";"init"===t&&a.includes(s)&&(MDC.lists.get("drawer-list").selectedIndex=a.indexOf(s))}static changeTheme(){V.items.theme="system"===V.items.theme?"light":"light"===V.items.theme?"dark":"system",document.documentElement.dataset.theme=V.items.theme,App.updateStaticElements("theme"),App.storageSet("theme",V.items.theme)}static clickListener=e=>{const t=e.target.closest("a");if(t instanceof HTMLAnchorElement&&new URL(t.href).origin===window.location.origin)return e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),App.pushState(void 0,t.href),App.router(),App.changeView(void 0,"click"),!1};static storageGet(e){let t;try{t=sessionStorage.getItem(e)}catch(e){}return t}static storageSet(e,t){try{sessionStorage.setItem(e,t)}catch(e){}}}App.init();