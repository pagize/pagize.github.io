/**
 * UI
 * @copyright (c) 2020 Six
 * @license https://github.com/sixcious/shr/blob/main/LICENSE
 */
class UI{static prepare(e,t){UI.cacheDOM(e),UI.seti18n(t),UI.setURLs(),UI.setupDocument(t),UI.updateSpecial(t),UI.updateChecks()}static cacheDOM(e){const t=document.querySelectorAll("[id]");for(const i of t)e["#"+i.id]=i}static seti18n(e){if("undefined"!=typeof chrome||"website"===V.APP){const t=document.querySelectorAll("[data-i18n]");for(const e of t)e[e.dataset.i18nProperty||"textContent"]=Util.i18nGetMessage(e.dataset.i18n||e.id);!1===e?.tooltipsEnabled?Tooltip.removeTooltips():Tooltip.addTooltips()}}static setURLs(){const e=document.querySelectorAll("a[href]");for(const t of e)t.href=t.href?.replaceAll("__app__",V.APP),t.href=t.href?.replaceAll("__discord__",V.DISCORD),t.textContent?.includes("__app__")&&(t.textContent=t.textContent.replaceAll("__app__",V.APP))}static setupDocument(e){document.documentElement.dataset.theme=e?.theme,document.documentElement.dataset.platform=e?.platformName,document.documentElement.dataset.browser=e?.browserName,document.documentElement.dataset.visibility="visible"}static updateSpecial(e){if(!e)return;e.specialTheme?document.documentElement.setAttribute("data-special-theme",""):document.documentElement.removeAttribute("data-special-theme");const t=document.querySelectorAll(".special-badge");for(const i of t)i.dataset.display=e.specialBadge?"inline":"none";document.querySelectorAll(".mdc-dialog__surface").forEach((t=>{e.specialTheme?(t.setAttribute("data-special-theme",""),t.setAttribute("data-special-theme-secondary","")):(t.removeAttribute("data-special-theme"),t.removeAttribute("data-special-theme-secondary"))})),V.DOM["#special-settings-description"]&&(V.DOM["#special-settings-description"].textContent=Util.i18nGetMessage("special_settings_"+(e.specialEnabled?"enabled_":"")+"description",["app",Util.i18nGetMessage("name")]))}static updateChecks(){if(V.checks){if(!V.checks.removeDialogFocuses){V.checks.removeDialogFocuses=!0;const e=document.querySelectorAll(".mdc-dialog[data-no-focus]");for(const t of e)MDC.dialogs.get(t.id).listen("MDCDialog:opened",(()=>{document.activeElement.blur()}))}if(!V.checks.addConfettiListeners){V.checks.addConfettiListeners=!0;const e=document.querySelectorAll(".confetti-interaction");for(const t of e)t.removeEventListener("click",UI.clickConfettiBuzzOut),t.addEventListener("click",UI.clickConfettiBuzzOut)}}}static async showError(e){V.messages=await Util.loadMessages(V.items?.language),UI.prepare(V.DOM,V.items),"object"!=typeof e&&(e={message:"string"==typeof e?e:""}),e.i18n&&(e.title=Util.i18nGetMessage("error_"+e.i18n+"_title"),e.description=Util.i18nGetMessage("error_"+e.i18n+"_description")),e.code||(e.code="E0X",e.title=Util.i18nGetMessage("error_exception_title")||"An exception was encountered",e.description=e.message||Util.i18nGetMessage("error_exception_description")),document.querySelector("#error-title").textContent=e.code+" "+e.title,document.querySelector("#error-description").textContent=e.description}static clickHoverCss(e,t){e.classList.remove(t),setTimeout((function(){e.classList.add(t)}),50)}static fireConfetti(e){const t=[{particleRatio:.25,spread:26,startVelocity:55,scalar:1,angle:45},{particleRatio:.2,spread:60,scalar:1,angle:135},{particleRatio:.35,spread:100,decay:.81,scalar:.8,angle:60},{particleRatio:.1,spread:120,startVelocity:25,decay:.82,scalar:1.2,angle:120},{particleRatio:.1,spread:120,startVelocity:45,angle:90}];for(const i of t)confetti(Object.assign({ticks:300,origin:{x:e.clientX/(document.documentElement?.clientWidth||1),y:e.clientY/(document.documentElement?.clientHeight||1)}},i,{particleCount:Math.floor(200*i.particleRatio)}))}static clickConfettiBuzzOut(e){UI.clickHoverCss(e.target,"hvr-buzz-out-click"),UI.fireConfetti(e)}}